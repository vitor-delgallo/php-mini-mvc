###############################################
# üåê Enable mod_rewrite for friendly URLs
###############################################
RewriteEngine On

###############################################
# üîí Block access to hidden files (.env, .git, etc.)
###############################################
<FilesMatch "^\.">
  Require all denied
</FilesMatch>

###############################################
# üîí Block access to sensitive file types
###############################################
<FilesMatch "\.(env|ini|log|sh|bak|sql|dist|pem|crt|key|tpl|lock|json|yml)$">
  Require all denied
</FilesMatch>

###############################################
# üîí Disable directory listing (prevent file exposure)
###############################################
Options -Indexes

###############################################
# ‚úÖ Allow direct access to index.php and /public assets
###############################################
RewriteCond %{REQUEST_URI} ^/index\.php$ [OR]
RewriteCond %{REQUEST_URI} ^/public/
RewriteRule .* - [L]

###############################################
# üìè Remove trailing slashes from URLs (for cleaner SEO)
###############################################
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ /$1 [R=301,L]

###############################################
# üîÅ Route all other requests to index.php (for central routing)
###############################################
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]

###############################################
# üß† Enable GZIP compression (faster page loads). You can enable it in production.
###############################################
#<IfModule mod_deflate.c>
#  AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css application/javascript application/json
#</IfModule>

###############################################
# üöÄ Smart caching for static assets. You can enable it in production.
###############################################
#<IfModule mod_expires.c>
#  ExpiresActive On
#  ExpiresDefault "access plus 1 month"
#
#  # Stylesheets and scripts
#  ExpiresByType text/css "access plus 7 days"
#  ExpiresByType text/javascript "access plus 7 days"
#  ExpiresByType application/javascript "access plus 7 days"
#  ExpiresByType application/x-javascript "access plus 7 days"
#
#  # Images
#  ExpiresByType image/png "access plus 1 month"
#  ExpiresByType image/jpeg "access plus 1 month"
#  ExpiresByType image/gif "access plus 1 month"
#  ExpiresByType image/webp "access plus 1 month"
#  ExpiresByType image/svg+xml "access plus 1 month"
#
#  # Fonts
#  ExpiresByType application/font-woff2 "access plus 1 year"
#  ExpiresByType application/font-woff "access plus 1 year"
#  ExpiresByType application/vnd.ms-fontobject "access plus 1 year"
#  ExpiresByType font/ttf "access plus 1 year"
#  ExpiresByType font/otf "access plus 1 year"
#</IfModule>

###############################################
# üîê Secure HTTP headers (for protection against common attacks)
###############################################
<IfModule mod_headers.c>
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "geolocation=(self), microphone=(self), camera=(self), accelerometer=(), autoplay=(self), usb=(), fullscreen=(self)"
</IfModule>